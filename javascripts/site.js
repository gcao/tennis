// Generated by CoffeeScript 1.4.0
(function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T={}.hasOwnProperty,N=[].slice;r="0.5.0",a=function(e){return e instanceof Array},l=function(e){return e!==null&&typeof e=="object"&&!(e instanceof Array)},c=function(e){return e!==null&&typeof e=="object"&&e.isTjsTemplate},f=function(e){var t;if(!e)return!0;for(t in e){if(!T.call(e,t))continue;return!1}return!0},o=function(e){var t,n,r,i,s;if(typeof e=="function")return!0;if(c(e))return!0;if(a(e))for(i=0,s=e.length;i<s;i++){t=e[i];if(o(t))return!0}else if(l(e))for(n in e){if(!T.call(e,n))continue;r=e[n];if(o(r))return!0}},s=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},x=function(e){return e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#039;/g,"'")},h=function(e,t){var n,r;if(!t)return e;if(!e)return t;for(n in t){if(!T.call(t,n))continue;r=t[n],e[n]=r}return e},t=/^<.*/,e=/^([^#.]+)?(#([^.]+))?(.(.*))?$/,y=function(n){var r,i,s,o,u,f,l,c,h,p;s=n[0];if(a(s))return n;if(typeof s!="string")throw"Invalid first argument "+s;if(s.match(t))return n;c=s.split(" ");if(c.length>1){o=c.length-1,h=n.slice(1);while(o>=0)l=c[o],h.unshift(l),h=[y(h)],o--;return h[0]}if(f=s.match(e)){p=f[1]||"div",u=f[3],i=f[5];if(u||i)r={},u&&(r.id=u),i&&(r["class"]=i.replace(/\./g," ")),n.splice(0,1,p,r)}return n},p=function(e){var t,n,r,i,s;if(!a(e))return e;for(n=i=s=e.length-1;s<=0?i<=0:i>=0;n=s<=0?++i:--i)r=p(e[n]),a(r)?(t=r[0],t===""?(r.shift(),e.splice.apply(e,[n,1].concat(N.call(r)))):a(t)&&e.splice.apply(e,[n,1].concat(N.call(r)))):typeof r!="undefined"&&r!==null&&r!==""&&(e[n]=r);return e},d=function(e){var t,n,r,i,s,o,u,a;r={},u=e.split(";");for(s=0,o=u.length;s<o;s++)n=u[s],a=n.split(":"),t=a[0],i=a[1],t&&i&&(r[t.trim()]=i.trim());return r},b=function(e){var t;return t=e.style,typeof t=="string"?e.style=d(t):l(t&&!f(t))&&(e.style=t),e},g=function(e,t){return e["class"]&&(t["class"]?t["class"]=e["class"]+" "+t["class"]:t["class"]=e["class"]),t},m=function(e){var t,n,r,i,s,o,u,c,p;if(a(e)){if(e.length===0)return e;t={},e=y(e);for(o=0,c=e.length;o<c;o++)r=e[o],a(r)?m(r):l(r)&&(b(r),s=t.style,i=r.style,g(t,r),t=h(t,r),s=h(s,i),f(s)||(t.style=s));for(n=u=p=e.length-1;p<=0?u<=0:u>=0;n=p<=0?++u:--u)l(e[n])&&e.splice(n,1);f(t)||e.splice(1,0,t)}return e},v=function(){var e,t;return t=arguments[0],e=2<=arguments.length?N.call(arguments,1):[],typeof t=="function"?v.apply(null,[t.apply(null,e)].concat(N.call(e))):c(t)?t.process.apply(t,e):t},E=function(e){var t,n,r,i,s,o,u;r="";for(t in e){if(!T.call(e,t))continue;u=e[t];if(t==="style"){o=e.style;if(l(o)){i="";for(n in o){if(!T.call(o,n))continue;s=o[n],i+=n+":"+s+";"}r+=' style="'+i+'"'}else r+=' style="'+o+'"'}else r+=" "+t+'="'+u+'"'}return r},S=function(e){var t;return function(){var n,r,i;i=[];for(n=0,r=e.length;n<r;n++)t=e[n],i.push(w(t));return i}().join("")},w=function(e){var t,n,r,i;if(typeof e=="undefined"||e===null)return"";if(!a(e))return""+e;if(e.length===0)return"";t=e.shift();if(a(t))return w(t)+function(){var t,r,i;i=[];for(t=0,r=e.length;t<r;t++)n=e[t],i.push(w(n));return i}().join("");if(t==="")return S(e);if(e.length===0)return t==="script"?"<"+t+"></"+t+">":"<"+t+"/>";r="<"+t,i=e.shift();if(l(i)){r+=E(i);if(e.length===0)return t==="script"?r+="></"+t+">":r+="/>",r;r+=">"}else{r+=">",r+=w(i);if(e.length===0)return r+="</"+t+">",r}return e.length>0&&(r+=S(e),r+="</"+t+">"),r},i=function(){var e;return e=function(){var t,n,r;return n=arguments[0],t=2<=arguments.length?N.call(arguments,1):[],r=e.use(n),t.length===0?r:r.process.apply(r,t)},u(e),e},u=function(e){var t;return e.create=i,e.templates={},e.internal={},t=function(e,t){return this.template=e,this.name=t,this.isTjsTemplate=!0},t.prototype.process=function(){var e,t;return e=1<=arguments.length?N.call(arguments,0):[],t=v.apply(null,[this.template].concat(N.call(e))),t=p(t),m(t)},t.prototype.render=function(){var e,t;return e=1<=arguments.length?N.call(arguments,0):[],t=this.process.apply(this,e),w(t)},t.prototype.prepare=function(n){var r,i,s;for(r in n){if(!T.call(n,r))continue;s=n[r],c(s)||(n[r]=new t(s))}return i=new t(this.template,this.name),i.process=function(){var r,i,s;r=1<=arguments.length?N.call(arguments,0):[];try{return e.internal.includes&&(i=e.internal.includes),n&&(e.internal.includes=n),(s=t.prototype.process).call.apply(s,[this].concat(N.call(r)))}finally{i?e.internal.includes=i:delete e.internal.includes}},i},e.process=function(){var e,n,r;return n=arguments[0],e=2<=arguments.length?N.call(arguments,1):[],(r=new t(n)).process.apply(r,e)},e.render=function(){var e,n,r;return n=arguments[0],e=2<=arguments.length?N.call(arguments,1):[],(r=new t(n)).render.apply(r,e)},e.include=function(){var t,n,r,i;return n=arguments[0],t=2<=arguments.length?N.call(arguments,1):[],(r=e.internal.includes)!=null?(i=r[n]).process.apply(i,t):void 0},e.define=e.def=function(n,r){return e.templates[n]=new t(r,n)},e.redefine=e.redef=function(n,r){var i,s,o;return s=e.use(n),i=new t(r),o=function(){var t,n;n=1<=arguments.length?N.call(arguments,0):[];try{return e.original&&(t=e.internal.original),e.internal.original=s,i.process.apply(i,n)}finally{t?e.internal.original=t:delete e.internal.original}},e.templates[n]=new t(o,n)},e.wrapped=function(){var t,n;return t=1<=arguments.length?N.call(arguments,0):[],(n=e.internal.original).process.apply(n,t)},e.use=function(t){return e.templates[t]},e.escape=s,e.unescape=x,e.VERSION=r},n=i(),n.internal.normalize=p,n.internal.processFirst=y,n.internal.parseStyles=d,n.internal.processStyles=b,n.internal.processAttributes=m,n.internal.render=w,n.internal.thisRef=this,n.noConflict=function(){return n.oldT?n.internal.thisRef.T=n.oldT:delete n.internal.thisRef.T,n},this.T&&(n.oldT=this.T),this.T=n,typeof module!="undefined"&&module!==null&&(module.exports=n)}).call(this),function(){window.getAtpUrl=function(e){return"http://www.atpworldtour.com"+e},window.getQueryVar=function(e){var t,n,r;return t=unescape(window.location.search)+"&",n=new RegExp(".*?[&\\?]"+e+"=(.*?)&.*"),r=t.replace(n,"$1"),r===t?!1:r},window.DEFAULT_PLAYERS=["novak_djokovic","roger_federer","andy_murray","rafael_nadal"],window.getPlayers=function(e){var t,n;return t=null,n=getQueryVar("players"),n&&n!==""?t=n.split(","):t=e},window.loadData=function(e,t){return useLocalData||getQueryVar("local_data")==="true"?$.getJSON("data/"+e+".json",t):$.getJSON("http://gcao.cloudant.com/tennis/"+e+"?callback=?",t)},window.loadData2=function(e){var t;return t=function(e){return useLocalData||getQueryVar("local_data")==="true"?"data/"+e+".json":"http://gcao.cloudant.com/tennis/"+e+"?callback=?"},$.when.apply($,$.map(e,function(e){return $.getJSON(t(e))}))},window.normalizeResults=function(e){var t,n,r,i;if(e[1]instanceof Array){i=[];for(n=0,r=e.length;n<r;n++)t=e[n],i.push(t[0]);return i}return[e[0]]},window.updateGenerationTime=function(e){var t,n,r,i;return t=new Date(e*1e3),r=t.getMonth()+1,n=t.getDate(),i=t.getYear()+1900,$(".generated-at").text(r+"/"+n+"/"+i)},window.getMap=function(){return new google.maps.Map(document.getElementById("map"),{zoom:3,center:new google.maps.LatLng(25,0),mapTypeId:google.maps.MapTypeId.ROADMAP})},window.getTournamentLogo=function(e,t){switch(e){case"atp250":return"http://www.atpworldtour.com/~/media/810218DC73784BEEA6EF0978B2842A69.ashx?w=31&h=36";case"atp500":return"http://www.atpworldtour.com/~/media/1DB04CA8505648B7B511FA1E37F1E3BA.ashx?w=31&h=36";case"atp1000":return"http://www.atpworldtour.com/~/media/F5219431817E4ED3B773BF9B006A9ACF.ashx?w=31&h=42";case"atptourfinal":return"http://www.atpworldtour.com/~/media/47F12472FD254B08B57755E5B7565E5D.ashx?w=31&h=48";case"grandslam":if(t.match(/australian open/i))return"images/ao_logo.png";if(t.match(/roland garros/i))return"images/fo_logo.png";if(t.match(/wimbledon/i))return"images/wo_logo.png";if(t.match(/us open/i))return"images/uo_logo.png"}},window.getTournamentPriority=function(e){switch(e){case"atp250":return 2;case"atp500":return 3;case"atp1000":return 4;case"atptourfinal":return 5;case"grandslam":return 6;default:return 1}},T.def("tournament-info-window",function(e){return["div.map-info",["p.tournament-name",["a",{href:"http://www.atpworldtour.com"+e.url,target:"_new"},e.name],"&nbsp;&nbsp;",T("buy-ticket-link",e,getTicketUrl(e.name))],["p.tournament-time",e.start],["p.tournament-place",e.place]]}),window.formatDate=function(e,t){return t==null&&(t="YYYY-MM-DD"),t=t.replace("DD",(e.getDate()<10?"0":"")+e.getDate()),t=t.replace("MM",(e.getMonth()<9?"0":"")+(e.getMonth()+1)),t.replace("YYYY",e.getFullYear())},window.isFuture=function(e){return e>formatDate(new Date)},window.getTicketUrl=function(e){var t,n,r;for(n=0,r=ticketUrls.length;n<r;n++){t=ticketUrls[n];if(t.name===e)return t.url}},T.def("buy-ticket-link",function(e,t){if(!e||!t)return;return["a.ticket_url",{href:t,rel:"nofollow"},"Buy&nbsp;Ticket"]})}.call(this),function(){window.loadAndShowRankHistory=function(e,t,n){if(e.length===0){alert("No player is chosen!");return}return loadRankHistory(e).then(function(){var e,r;return r=arguments[0]instanceof Array?arguments:[arguments],e=$.map(r,function(e){return e[0]}),showRankHistory(e,t,n)})},window.loadRankHistory=function(e){return $.when.apply($,$.map(e,function(e){return loadData(e+"_rank_history")}))},window.showRankHistory=function(e,t,n){return e=$.map(e,function(e){var r;return r=filterHistoryData(e.history,t,n),{key:e.first+" "+e.last,values:r}}),nv.addGraph(function(){var t;return t=nv.models.lineChart().x(function(e){return Date.parse(e[0])}).y(function(e){return 50-e[1]}).margin({left:20,right:40}).color(d3.scale.category10().range()),t.xAxis.rotateLabels(30).tickValues(function(){return $.map(getYears(),function(e){return Date.parse("1/1/"+e)})}()).tickFormat(function(e){return d3.time.format("%x")(new Date(e))}),t.yAxis.tickValues([0,10,20,30,40,45,46,47,48,49]).showMaxMin(!1).tickFormat(function(e){return 50-e}),d3.select("#rank-history svg").datum(e).transition().duration(500).call(t),nv.utils.windowResize(t.update),window.chart=t,t})},window.getYear=function(){return(new Date).getYear()+1900},window.getYears=function(){var e,t;t=[],e=2003;while(e<=getYear())t[e-2003]=e,e++;return t},window.filterHistoryData=function(e,t,n){var r,i;return r=Date.parse(t+"/1/1"),i=Date.parse(parseInt(n)+1+"/1/1"),$.map(e,function(e){var t;t=Date.parse(e[0]);if(t>=r&&t<i)return[e]})},window.initFromYear=function(){var e,t;$("[name=fromYear]").html(""),e=2003,t=[];while(e<=getYear())$("[name=fromYear]").append("<option>"+e+"</option>"),t.push(e++);return t},window.initToYear=function(e){var t,n;$("[name=toYear]").html(""),t=e,n=[];while(t<=getYear())$("[name=toYear]").append("<option>"+t+"</option>"),n.push(t++);return n},window.changeFromYear=function(){var e,t,n;e=$("[name = fromYear]").val(),t=$("[name = toYear]").val(),$("[name=toYear]").html(""),n=parseInt(e);while(n<=getYear())$("[name=toYear]").append("<option>"+n+"</option>"),n++;return $("[name=toYear]").val(t?t:getYear())}}.call(this),function(){}.call(this);