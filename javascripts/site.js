function getQueryVar(e){var t=unescape(window.location.search)+"&",n=new RegExp(".*?[&\\?]"+e+"=(.*?)&.*");return val=t.replace(n,"$1"),val==t?!1:val}function updateGenerationTime(e){var t=new Date(e*1e3),n=t.getMonth()+1,r=t.getDate(),i=t.getYear()+1900;$(".generated-at").text(n+"/"+r+"/"+i)}function loadAndShowRankHistory(e,t,n){if(e.length==0){alert("No player is chosen!");return}loadRankHistory(e).then(function(){var e=$.map(arguments,function(e){return e[0]});showRankHistory(e,t,n)})}function loadRankHistory(e){return $.when.apply($,$.map(e,function(e){return $.getJSON("data/"+e+"_rank_history.json")}))}function showRankHistory(e,t,n){e=$.map(e,function(e){var r=filterHistoryData(e.history,t,n);return{key:e.first+" "+e.last,values:r}}),nv.addGraph(function(){var t=nv.models.lineChart().x(function(e){return Date.parse(e[0])}).y(function(e){return 50-e[1]}).margin({left:20,right:40}).color(d3.scale.category10().range());return t.xAxis.rotateLabels(30).tickValues(function(){return $.map(getYears(),function(e){return Date.parse("1/1/"+e)})}()).tickFormat(function(e){return d3.time.format("%x")(new Date(e))}),t.yAxis.tickValues([0,10,20,30,40,45,46,47,48,49]).showMaxMin(!1).tickFormat(function(e){return 50-e}),d3.select("#rank-history svg").datum(e).transition().duration(500).call(t),nv.utils.windowResize(t.update),window.chart=t,t})}function getYear(){return(new Date).getYear()+1900}function getYears(){var e=[];for(year=2003;year<=getYear();year++)e[year-2003]=year;return e}function filterHistoryData(e,t,n){var r=Date.parse(t+"/1/1"),i=Date.parse(parseInt(n)+1+"/1/1");return $.map(e,function(e){var t=Date.parse(e[0]);if(t>=r&&t<i)return[e]})}function initFromYear(){$("[name=fromYear]").html("");for(var e=2003;e<=getYear();e++)$("[name=fromYear]").append("<option>"+e+"</option>")}function initToYear(e){$("[name=toYear]").html("");for(var t=e;t<=getYear();t++)$("[name=toYear]").append("<option>"+t+"</option>")}function changeFromYear(){var e=$("[name=fromYear]").val(),t=$("[name=toYear]").val();$("[name=toYear]").html("");for(var n=parseInt(e);n<=getYear();n++)$("[name=toYear]").append("<option>"+n+"</option>");$("[name=toYear]").val(t?t:getYear())}$(document).ready(function(){location.pathname.match(/rankings/)?$("li.rankings").addClass("current"):location.pathname.match(/rank-history/)?$("li.rank-history").addClass("current"):location.pathname.match(/tournaments/)?$("li.tournaments").addClass("current"):location.pathname.match(/support/)&&$("li.support").addClass("current")});