(function(){window.loadAndShowRankHistory=function(e,t,n){if(e.length===0){alert("No player is chosen!");return}return loadRankHistory(e).then(function(){var e,r;return r=arguments[0]instanceof Array?arguments:[arguments],e=$.map(r,function(e){return e[0]}),showRankHistory(e,t,n)})},window.loadRankHistory=function(e){return $.when.apply($,$.map(e,function(e){return loadData(e+"_rank_history")}))},window.showRankHistory=function(e,t,n){return e=$.map(e,function(e){var r;return r=filterHistoryData(e.history,t,n),{key:e.first+" "+e.last,values:r}}),nv.addGraph(function(){var t;return t=nv.models.lineChart().x(function(e){return Date.parse(e[0])}).y(function(e){return 50-e[1]}).margin({left:20,right:40}).color(d3.scale.category10().range()),t.xAxis.rotateLabels(30).tickValues(function(){return $.map(getYears(),function(e){return Date.parse("1/1/"+e)})}()).tickFormat(function(e){return d3.time.format("%x")(new Date(e))}),t.yAxis.tickValues([0,10,20,30,40,45,46,47,48,49]).showMaxMin(!1).tickFormat(function(e){return 50-e}),d3.select("#rank-history svg").datum(e).transition().duration(500).call(t),nv.utils.windowResize(t.update),window.chart=t,t})},window.getYear=function(){return(new Date).getYear()+1900},window.getYears=function(){var e,t;t=[],e=2003;while(e<=getYear())t[e-2003]=e,e++;return t},window.filterHistoryData=function(e,t,n){var r,i;return r=Date.parse(t+"/1/1"),i=Date.parse(parseInt(n)+1+"/1/1"),$.map(e,function(e){var t;t=Date.parse(e[0]);if(t>=r&&t<i)return[e]})},window.initFromYear=function(){var e,t;$("[name=fromYear]").html(""),e=2003,t=[];while(e<=getYear())$("[name=fromYear]").append("<option>"+e+"</option>"),t.push(e++);return t},window.initToYear=function(e){var t,n;$("[name=toYear]").html(""),t=e,n=[];while(t<=getYear())$("[name=toYear]").append("<option>"+t+"</option>"),n.push(t++);return n},window.changeFromYear=function(){var e,t,n;e=$("[name = fromYear]").val(),t=$("[name = toYear]").val(),$("[name=toYear]").html(""),n=parseInt(e);while(n<=getYear())$("[name=toYear]").append("<option>"+n+"</option>"),n++;return $("[name=toYear]").val(t?t:getYear())}}).call(this);