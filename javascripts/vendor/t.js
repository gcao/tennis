// Generated by CoffeeScript 1.4.0
(function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y={}.hasOwnProperty,b=[].slice;i=function(e){return e instanceof Array},o=function(e){return e!==null&&typeof e=="object"&&!(e instanceof Array)},s=function(e){var t;if(!e)return!0;for(t in e){if(!y.call(e,t))continue;return!1}return!0},r=function(e){var t,n,s,u,a;if(typeof e=="function")return!0;if(i(e))for(u=0,a=e.length;u<a;u++){t=e[u];if(r(t))return!0}else if(o(e)){if(e.isTemplate)return!0;for(n in e){if(!y.call(e,n))continue;s=e[n];if(r(s))return!0}}},u=function(e,t){var n,r;if(!t)return e;if(!e)return t;for(n in t){if(!y.call(t,n))continue;r=t[n],e[n]=r}return e},e=/^([^#.]+)?(#([^.]+))?(.(.*))?$/,p=function(t){var n,r,i,s,o,u;i=t[0];if(typeof i!="string")throw"Invalid first argument "+i;if(o=i.match(e)){u=o[1],s=o[3],r=o[5];if(s||r)n={},s&&(n.id=s),r&&(n["class"]=r.replace("."," ")),t.splice(0,1,u,n)}return t},a=function(e){var t,n,r,s;if(!i(e))return e;for(t=r=s=e.length-1;s<=0?r<=0:r>=0;t=s<=0?++r:--r)n=a(e[t]),i(n)?n[0]===""&&(n.shift(),e.splice.apply(e,[t,1].concat(b.call(n)))):typeof n!="undefined"&&n!==null&&n!==""&&(e[t]=n);return e},f=function(e){var t,n,r,i,s,o,u,a;r={},u=e.split(";");for(s=0,o=u.length;s<o;s++)n=u[s],a=n.split(":"),t=a[0],i=a[1],t&&i&&(r[t.trim()]=i.trim());return r},d=function(e){var t,n,r;return t={},n=e.style,typeof n=="string"&&(t=u(t,f(n))),r=e.styles,typeof r=="string"&&(t=u(t,f(r))),o(n)&&(t=u(t,n)),o(r)&&(t=u(t,r)),delete e.styles,s(t)||(e.style=t),e},h=function(e,t){return e["class"]&&(t["class"]?t["class"]=e["class"]+" "+t["class"]:t["class"]=e["class"]),t},c=function(e){var t,n,r,a,f,l,v,m,g;if(i(e)){t={},e=p(e);for(l=0,m=e.length;l<m;l++)r=e[l],i(r)?c(r):o(r)&&(d(r),f=t.style,a=r.style,h(t,r),t=u(t,r),f=u(f,a),s(f)||(t.style=f));for(n=v=g=e.length-1;g<=0?v<=0:v>=0;n=g<=0?++v:--v)o(e[n])&&e.splice(n,1);s(t)||e.splice(1,0,t)}return e},l=function(e,t){var n,s,u,a,f,c,h;if(typeof e=="function")return l(e(t),t);if(i(e)){if(r(e)){h=[];for(f=0,c=e.length;f<c;f++)n=e[f],h.push(l(n,t));return h}return e}if(o(e)){if(e.isTemplate)return l(e.process(t),t);if(r(e)){u={};for(s in e)a=e[s],u[s]=l(a,t);return u}return e}return e},m=function(e){var t,n,r,i,s,u,a;r="";for(t in e){if(!y.call(e,t))continue;a=e[t];if(t==="style"){u=e.style;if(o(u)){i="";for(n in u){if(!y.call(u,n))continue;s=u[n],i+=n+":"+s+";"}r+=' style="'+i+'"'}else r+=' style="'+u+'"'}else r+=" "+t+'="'+a+'"'}return r},g=function(e){var t;return function(){var n,r,i;i=[];for(n=0,r=e.length;n<r;n++)t=e[n],i.push(v(t));return i}().join("")},v=function(e){var t,n,r;if(typeof e=="undefined"||e===null)return"";if(!i(e))return""+e;if(e.length===0)return"";t=e.shift();if(t==="")return g(e);if(e.length===0)return"<"+t+"/>";n="<"+t,r=e.shift();if(o(r)){n+=m(r);if(e.length===0)return n+="/>",n;n+=">"}else{n+=">",n+=v(r);if(e.length===0)return n+="</"+t+">",n}return e.length>0&&(n+=g(e),n+="</"+t+">"),n},n=function(){var e;return e=1<=arguments.length?b.call(arguments,0):[],this.template=e,this.isTemplate=!0,this.template.length===1&&i(this.template[0])&&(this.template=this.template[0]),this},n.prototype.map=function(e){return this.mapper=e,this},n.prototype.process=function(e){var t;return this.mapper&&(e=this.mapper(e)),t=l(this.template,e),t=a(t),c(t)},n.prototype.render=function(e){var t;return t=this.process(e),v(t)},t=function(){var e;return e=1<=arguments.length?b.call(arguments,0):[],e.length===1&&e[0].isTemplate?e[0]:function(e,t,n){n.prototype=e.prototype;var r=new n,i=e.apply(r,t);return Object(i)===i?i:r}(n,e,function(){})},t.process=function(e,t){return(new n(e)).process(t)},t.render=function(e,t){return(new n(e)).render(t)},t.value=function(e,t){return typeof t=="undefined"&&(t=null),function(n){var r,i,s,o;if(!n)return t;i=e.split(".");for(s=0,o=i.length;s<o;s++){r=i[s],n=n[r];if(typeof n=="undefined"||n===null)return t}return typeof n=="undefined"||n===null?t:n}},t.escape=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},t.unescape=function(e){return e.replace(/&amp;/,"&").replace(/&lt;/,"<").replace(/&gt;/,">").replace(/&quot;/,'"').replace(/&#039;/,"'")},t.utils={normalize:a,processFirst:p,parseStyles:f,processStyles:d,processAttributes:c,render:v},this.T=t,typeof module!="undefined"&&module!==null&&(module.exports=t)}).call(this);