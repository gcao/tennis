/**
 * DEVELOPED BY
 * GIL LOPES BUENO
 * gilbueno.mail@gmail.com
 *
 * WORKS WITH:
 * IE 9+, FF 4+, SF 5+, WebKit, CH 7+, OP 12+, BESEN, Rhino 1.7+
 *
 * FORK:
 * https://github.com/melanke/Watch.JS
 */
"use strict";(function(e){typeof exports=="object"?module.exports=e():typeof define=="function"&&define.amd?define(e):(window.WatchJS=e(),window.watch=window.WatchJS.watch,window.unwatch=window.WatchJS.unwatch,window.callWatchers=window.WatchJS.callWatchers)})(function(){var e={noMore:!1},t=[],n=function(e){var t={};return e&&t.toString.call(e)=="[object Function]"},r=function(e){return e%1===0},i=function(e){return Object.prototype.toString.call(e)==="[object Array]"},s=function(e,t){var n=[],r=[];if(typeof e!="string"&&typeof t!="string"&&!i(e)&&!i(t)){for(var s in e)t[s]===undefined&&n.push(s);for(var o in t)e[o]===undefined&&r.push(o)}return{added:n,removed:r}},o=function(e){if(null==e||"object"!=typeof e)return e;var t=e.constructor();for(var n in e)t[n]=e[n];return t},u=function(e,t,n,r){try{Object.observe(e[t],function(e){r(e)})}catch(i){try{Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}catch(s){try{Object.prototype.__defineGetter__.call(e,t,n),Object.prototype.__defineSetter__.call(e,t,r)}catch(o){throw new Error("watchJS error: browser not supported :/")}}}},a=function(e,t,n){try{Object.defineProperty(e,t,{enumerable:!1,configurable:!0,writable:!1,value:n})}catch(r){e[t]=n}},f=function(){n(arguments[1])?l.apply(this,arguments):i(arguments[1])?c.apply(this,arguments):h.apply(this,arguments)},l=function(e,t,n,r){if(typeof e=="string"||!(e instanceof Object)&&!i(e))return;var s=[];if(i(e))for(var o=0;o<e.length;o++)s.push(o);else for(var u in e)s.push(u);c(e,s,t,n,r),r&&x(e,"$$watchlengthsubjectroot",t,n)},c=function(e,t,n,r,s){if(typeof e=="string"||!(e instanceof Object)&&!i(e))return;for(var o in t)h(e,t[o],n,r,s)},h=function(e,t,r,s,o){if(typeof e=="string"||!(e instanceof Object)&&!i(e))return;if(n(e[t]))return;e[t]!=null&&(s===undefined||s>0)&&(s!==undefined&&s--,l(e[t],r,s)),m(e,t,r),o&&x(e,t,r,s)},p=function(){n(arguments[1])?d.apply(this,arguments):i(arguments[1])?v.apply(this,arguments):E.apply(this,arguments)},d=function(e,t){if(e instanceof String||!(e instanceof Object)&&!i(e))return;var n=[];if(i(e))for(var r=0;r<e.length;r++)n.push(r);else for(var s in e)n.push(s);v(e,n,t)},v=function(e,t,n){for(var r in t)E(e,t[r],n)},m=function(t,n,r){var i=t[n];w(t,n),t.watchers||a(t,"watchers",{}),t.watchers[n]||(t.watchers[n]=[]);for(var s in t.watchers[n])if(t.watchers[n][s]===r)return;t.watchers[n].push(r);var o=function(){return i},f=function(s){var o=i;i=s,t[n]&&l(t[n],r),w(t,n),e.noMore||JSON.stringify(o)!==JSON.stringify(s)&&(g(t,n,"set",s,o),e.noMore=!1)};u(t,n,o,f)},g=function(e,t,n,i,s){if(t)for(var o in e.watchers[t])r(o)&&e.watchers[t][o].call(e,t,n,i||e[t],s);else for(var t in e)g(e,t,n,i,s)},y=["pop","push","reverse","shift","sort","slice","splice","unshift"],b=function(e,t,n,r){a(e[t],r,function(){var i=n.apply(e[t],arguments);return h(e,e[t]),r!=="slice"&&g(e,t,r,arguments),i})},w=function(e,t){if(!e[t]||e[t]instanceof String||!i(e[t]))return;for(var n=y.length,r;n--;)r=y[n],b(e,t,e[t][r],r)},E=function(e,t,n){for(var r in e.watchers[t]){var i=e.watchers[t][r];i==n&&e.watchers[t].splice(r,1)}T(e,t,n)},S=function(){for(var e in t){var n=t[e];if(n.prop==="$$watchlengthsubjectroot"){var r=s(n.obj,n.actual);if(r.added.length||r.removed.length)r.added.length&&c(n.obj,r.added,n.watcher,n.level-1,!0),n.watcher.call(n.obj,"root","differentattr",r,n.actual);n.actual=o(n.obj)}else{var r=s(n.obj[n.prop],n.actual);if(r.added.length||r.removed.length){if(r.added.length)for(var i in n.obj.watchers[n.prop])c(n.obj[n.prop],r.added,n.obj.watchers[n.prop][i],n.level-1,!0);g(n.obj,n.prop,"differentattr",r,n.actual)}n.actual=o(n.obj[n.prop])}}},x=function(e,n,r,i){var s;n==="$$watchlengthsubjectroot"?s=o(e):s=o(e[n]),t.push({obj:e,prop:n,actual:s,watcher:r,level:i})},T=function(e,n,r){for(var i in t){var s=t[i];s.obj==e&&s.prop==n&&s.watcher==r&&t.splice(i,1)}};return setInterval(S,50),e.watch=f,e.unwatch=p,e.callWatchers=g,e});